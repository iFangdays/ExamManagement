{"version":3,"sources":["webpack:///./src/pages/cascadeManage/index.vue?4aa8","webpack:///./src/pages/cascadeManage/index.vue","webpack:///./src/pages/cascadeManage/index.vue?412e","webpack:///./src/pages/cascadeManage/index.vue?1c64","webpack:///./src/pages/cascadeManage/index.vue?6f87"],"names":["loading","ref","sortOptions","onlyFatherOptions","props","children","label","value","getSortOptions","getAllQuestionType","then","res","map","i","questionTypes","length","item","typeName","id","finally","getTableData","formInline","reactive","rules","categoryName","required","message","trigger","parentId","formOptions","prop","type","options","tableData","checkStrictly","totalData","pageable","page","limit","columns","render","row","findFields","toRaw","typeId","width","fixed","_createVNode2","_resolveComponent2","onClick","openDialog","default","_createTextVNode2","deleteCategories","categoryId","ElMessageBox","confirm","confirmButtonText","cancelButtonText","params","deleteCategory","catch","ElMessage","getAllCategories","refresh","search","msg","warning","onMounted","detailData","show","data","onSizeChange","val","pageSize","onCurrentChange","pageNum","__exports__","___CSS_LOADER_API_IMPORT___","exports","push","module","content","__esModule","locals","add"],"mappings":"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","file":"js/chunk-534f9d02.d5bb4e8b.js","sourcesContent":["export * from \"-!../../../node_modules/vue-style-loader/index.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./index.vue?vue&type=style&index=0&id=59434059&scoped=true&lang=scss\"","<template>\r\n  <div class=\"content\" v-loading=\"loading\">\r\n    <div class=\"search\">\r\n      <el-form :inline=\"true\" :model=\"formInline\" class=\"demo-form-inline\">\r\n        <el-form-item label=\"所属分类\">\r\n          <el-cascader\r\n              v-model=\"formInline.id\"\r\n              :options=\"sortOptions\"\r\n              :props=\"props\"\r\n          />\r\n        </el-form-item>\r\n      </el-form>\r\n      <div class=\"btns\">\r\n        <el-button type=\"primary\" :icon=\"Search\" @click.stop=\"search\">查询</el-button>\r\n        <el-button :icon=\"Refresh\" @click.stop=\"refresh\">重置</el-button>\r\n        <el-button type=\"primary\" :icon=\"Plus\" @click.stop=\"openDialog(1)\">新增</el-button>\r\n      </div>\r\n    </div>\r\n    <div class=\"table_box\">\r\n      <CommonTable :tableData=\"tableData\"\r\n                   :columns=\"columns\"\r\n                   :totalData=\"totalData\"\r\n                   :pageable=\"pageable\"\r\n                    row-key=\"id\"\r\n                   default-expand-all\r\n                   :tree-props=\"{children:'categories'}\"\r\n                   @onSizeChange=\"onSizeChange\"\r\n                   @onCurrentChange=\"onCurrentChange\" />\r\n    </div>\r\n    <template v-if=\"detailData.show\">\r\n      <CommonDialogForm\r\n          v-model=\"detailData.show\"\r\n          title=\"联级管理\"\r\n          :rules='rules'\r\n          :dialogType=\"detailData.type\"\r\n          :form-data=\"detailData.data\"\r\n          :form-option=\"formOptions()\"\r\n          :update-request-url=\"updateCategory\"\r\n          :add-request-url=\"addCategory\"\r\n          @refresh-data=\"getTableData\"\r\n      />\r\n    </template>\r\n  </div>\r\n</template>\r\n\r\n<script setup lang=\"jsx\">\r\nimport CommonTable from \"@/components/commonTable\";\r\nimport CommonDialogForm from \"@/components/CommonDialogForm\"\r\nimport {reactive, ref, onMounted,toRaw} from \"vue\";\r\nimport { ElMessage,ElMessageBox } from 'element-plus'\r\nimport { Search, Refresh, Plus } from '@element-plus/icons-vue'\r\nimport {getAllCategories,addCategory,updateCategory,deleteCategory} from \"@/api/cascadeManageApi\"\r\nimport {getAllQuestionType} from \"@/api/tagManageApi\"\r\nimport {findFields} from \"@/utils/utilsTool.js\"\r\n\r\nconst loading = ref(false)\r\n\r\nconst sortOptions = ref([])\r\nconst onlyFatherOptions = ref([])\r\nconst props = { children:'questionTypes',label:'typeName',value:'id' }\r\nfunction getSortOptions(){\r\n  getAllQuestionType()\r\n      .then(res=>{\r\n        onlyFatherOptions.value = res.map(i=>{\r\n          if(i.questionTypes.length){\r\n           return i.questionTypes.map(item=>{\r\n              return {label:item.typeName,value:item.id}\r\n            })\r\n          }\r\n        })    \r\n        sortOptions.value =  res\r\n      })\r\n      .finally(()=>getTableData())\r\n}\r\n\r\nconst formInline = reactive({\r\n  id:[1,2],\r\n})\r\n\r\nconst rules = {\r\n  categoryName:[{required: true, message: '请输入联级名称', trigger: 'blur'}],\r\n  parentId:[{required: true, message: '请选择所属父类', trigger: 'blur'}],\r\n}\r\n\r\nconst formOptions = ()=>[\r\n  {label:'联级名称',prop:'categoryName',type:'input'},\r\n  {label:'所属分类',prop:'typeId',type:'cascader',options:sortOptions.value,props:{ children:'questionTypes',label:'typeName',value:'id' }},\r\n  {label:'父级分类',prop:'parentId',type:'cascader',options:tableData.value,props:{children:'categories',label:'categoryName',value:'id',checkStrictly:true}}\r\n]\r\n\r\nconst totalData = ref(0)\r\nconst pageable = reactive({\r\n  page: 1, limit: 15\r\n})\r\nconst tableData = ref([])\r\nconst columns = ref([\r\n  {label:'联级名称', prop:'categoryName'},\r\n  {label:'分类ID', prop:'typeId',render:({row})=>{\r\n    let res = findFields(toRaw(sortOptions.value),'id',row.typeId,'questionTypes')\r\n    return res && res.typeName \r\n  }},\r\n  {label:'创建时间', prop:'createTime'},\r\n  {\r\n    label: \"操作\", width: 120, fixed: 'right', render: ({row}) => {\r\n      return (\r\n          <div>\r\n            <el-button type=\"primary\" link onClick={()=>openDialog(0,row)}>\r\n              编辑\r\n            </el-button>\r\n            <el-button type=\"danger\" link onClick={()=>deleteCategories(row.id)}>\r\n              删除\r\n            </el-button>\r\n          </div>\r\n      )\r\n    }\r\n  },\r\n])\r\n\r\nonMounted(()=>{\r\n  getSortOptions()\r\n})\r\n\r\nfunction deleteCategories(categoryId){\r\n  ElMessageBox.confirm('确定删除吗？',{confirmButtonText:'确定',cancelButtonText:'取消'}).then(()=>{\r\n    let params = {categoryId}\r\n    deleteCategory(params)\r\n    .then(res=>{\r\n      getTableData()\r\n    })\r\n  }).catch(()=>{\r\n    ElMessage({type:'info',message:'已取消'})\r\n  })\r\n}\r\n\r\nfunction getTableData(typeId = 2){\r\n  loading.value = true\r\n  let params = {typeId}\r\n  getAllCategories(params)\r\n    .then(res=>{\r\n      tableData.value = res\r\n    })\r\n     .finally(()=>loading.value = false)\r\n}\r\n\r\nfunction refresh(){\r\n  formInline.id = [1,2]\r\n  pageable.page = 1\r\n  getTableData()\r\n}\r\n\r\nfunction search(){\r\n  let {id} = formInline\r\n  if(!id.length){\r\n    msg.warning('请选择分类')\r\n  }else{\r\n    pageable.page = 1\r\n    getTableData(id[id.length - 1])\r\n  }\r\n}\r\n\r\nconst detailData = reactive({\r\n  show:false,\r\n  type:0,\r\n  data:{}\r\n})\r\nfunction openDialog(type=0,data){\r\n  detailData.show = true\r\n  detailData.type = type\r\n  detailData.data = data\r\n}\r\n\r\nfunction onSizeChange(val) {\r\n  pageable.pageSize = val\r\n  getTableData()\r\n}\r\n\r\nfunction onCurrentChange(val) {\r\n  pageable.pageNum = val\r\n  getTableData()\r\n}\r\n\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n.content {\r\n  height: 100%;\r\n  background: #ffffff;\r\n  padding: 20px 10px;\r\n  .search{\r\n    height: 80px;\r\n    display: flex;\r\n    justify-content: space-between;\r\n  }\r\n  .table_box{\r\n    height: calc(100% - 80px);\r\n  }\r\n}\r\n</style>\r\n","import script from \"./index.vue?vue&type=script&setup=true&lang=jsx\"\nexport * from \"./index.vue?vue&type=script&setup=true&lang=jsx\"\n\nimport \"./index.vue?vue&type=style&index=0&id=59434059&scoped=true&lang=scss\"\n\nimport exportComponent from \"/Users/fang/Downloads/uniapp-考试测试/exammanage/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-59434059\"]])\n\nexport default __exports__","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".el-menu .el-menu-item[data-v-59434059],.el-menu .el-sub-menu__title[data-v-59434059]{color:#666;font-size:.08333rem;position:relative}.el-menu .el-menu-item svg[data-v-59434059],.el-menu .el-sub-menu__title svg[data-v-59434059]{font-size:.13542rem;margin:-.01042rem .05208rem 0 0}.el-menu .el-menu-item .xian[data-v-59434059],.el-menu .el-sub-menu__title .xian[data-v-59434059]{position:absolute;left:.18229rem;top:0;bottom:0;border-left:.01042rem solid #edeff2}.el-menu .el-menu-item.is-active[data-v-59434059],.el-menu .el-menu-item[data-v-59434059]:hover,.el-menu .el-sub-menu__title.is-active[data-v-59434059],.el-menu .el-sub-menu__title[data-v-59434059]:hover{background-color:rgba(0,0,0,.1);color:var(--color1,#0c969a)}.el-menu .el-menu-item.is-active .xian[data-v-59434059],.el-menu .el-menu-item:hover .xian[data-v-59434059],.el-menu .el-sub-menu__title.is-active .xian[data-v-59434059],.el-menu .el-sub-menu__title:hover .xian[data-v-59434059]{border-left:.01042rem solid var(--color1,#0c969a)}.el-menu--collapse .el-menu-item svg[data-v-59434059],.el-menu--collapse .el-sub-menu__title svg[data-v-59434059]{margin:0}.el-menu--vertical .el-menu[data-v-59434059]{background-color:#fff}.el-menu--vertical .el-menu .el-menu-item[data-v-59434059]:hover{background-color:rgba(0,0,0,.1)}.content[data-v-59434059]{height:100%;background:#fff;padding:.10417rem .05208rem}.content .search[data-v-59434059]{height:.41667rem;display:flex;justify-content:space-between}.content .table_box[data-v-59434059]{height:calc(100% - .41667rem)}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./index.vue?vue&type=style&index=0&id=59434059&scoped=true&lang=scss\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"7236576c\", content, true, {\"sourceMap\":false,\"shadowMode\":false});"],"sourceRoot":""}